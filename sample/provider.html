<!DOCTYPE html>
<head>
  <meta charset=utf-8>
  <meta name="description" content="Acthesis test">
  <title>Acthesis test - Provider</title>
</head>
<body>
  <h1>Acthesis test - Provider</h1>
  <h2>Shared URLS</h2>
  <ul id="shared">
  </ul>
  <script src="engine.io.js"></script>
  <script src="activity-common.js"></script>
  <script src="activity-client.js"></script>
  <script>
window.addEventListener('load', function () {
  var sharedList = document.getElementById('shared');
  if (typeof window.MozActivity === 'undefined') {
    var manifest = {
      "activities": {
        "share": {
          "href": null,        // default to current URL
          "disposition": 'inline', // 'window' (default) or 'inline'
          "filters": {
            "type": []         // @TODO
          },
          "returnValue": true
        }
      }
    }
    new Acthesis(null, manifest);
  }
  handler = function (message) {
    "use strict";
    if (!(message instanceof ActivityRequestHandler)) {
      console.error("Message should be an ActivityRequestHandler");
    }
    console.log("Sharing", message);
    sharedList.innerHTML += "<li>" + message.source.url + "</li>";
    message.postResult(message.source.url);
  };
  navigator.setMessageHandler('share', handler);
  //console.log(navigator.mozHasPendingMessage('share'));
  //console.log(navigator.mozHasPendingMessage('pick'));
});
  </script>
</body>
</html>

